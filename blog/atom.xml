<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://guru.kevin2li.top/blog</id>
    <title>PDF Guru Anki Blog</title>
    <updated>2025-02-07T08:40:17.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://guru.kevin2li.top/blog"/>
    <subtitle>PDF Guru Anki Blog</subtitle>
    <icon>https://guru.kevin2li.top/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[FRP实现内网穿透教程]]></title>
        <id>https://guru.kevin2li.top/blog/frp</id>
        <link href="https://guru.kevin2li.top/blog/frp"/>
        <updated>2025-02-07T08:40:17.000Z</updated>
        <summary type="html"><![CDATA[一、前言]]></summary>
        <content type="html"><![CDATA[<h3 class="anchor anchorWithStickyNavbar_LWe7" id="一前言"><strong>一、前言</strong><a href="https://guru.kevin2li.top/blog/frp#%E4%B8%80%E5%89%8D%E8%A8%80" class="hash-link" aria-label="一前言的直接链接" title="一前言的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-什么是内网穿透"><strong>1. 什么是内网穿透？</strong><a href="https://guru.kevin2li.top/blog/frp#1-%E4%BB%80%E4%B9%88%E6%98%AF%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F" class="hash-link" aria-label="1-什么是内网穿透的直接链接" title="1-什么是内网穿透的直接链接">​</a></h4>
<p>在日常生活和工作中，我们常常需要访问位于家庭或公司内网的设备（如NAS、监控摄像头、本地服务器等），或对外暴露本地的开发环境（如网站、API服务）。然而，由于大多数网络环境处于NAT（网络地址转换）或防火墙的保护下，外网设备无法直接访问内网资源——这就是典型的“内外网隔离”问题。</p>
<p><strong>内网穿透（NAT穿透）</strong> 技术应运而生。它通过建立一条从内网到公网服务器的“隧道”，将内网服务的端口映射到公网，使得外网用户可以通过访问公网地址间接访问内网资源。简单来说，就像为你的内网设备安装了一个“虚拟公网IP”，彻底打破网络边界限制。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-为什么选择frp"><strong>2. 为什么选择FRP？</strong><a href="https://guru.kevin2li.top/blog/frp#2-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%80%89%E6%8B%A9frp" class="hash-link" aria-label="2-为什么选择frp的直接链接" title="2-为什么选择frp的直接链接">​</a></h4>
<p>在众多内网穿透工具中，<a href="https://github.com/fatedier/frp" target="_blank" rel="noopener noreferrer">FRP（Fast Reverse Proxy）</a> 凭借以下优势脱颖而出：</p>
<ul>
<li><strong>开源免费</strong>：基于MIT协议，代码透明可定制，无商业限制。</li>
<li><strong>跨平台支持</strong>：服务端和客户端均支持Windows、Linux、macOS，甚至树莓派等ARM设备。</li>
<li><strong>配置灵活</strong>：支持TCP/UDP端口映射、HTTP/HTTPS反向代理、流量加密等功能，覆盖99%的穿透需求。</li>
<li><strong>轻量高效</strong>：单文件部署，内存占用低，对老旧设备友好。</li>
<li><strong>社区活跃</strong>：GitHub 9万+ Star，中文文档完善，问题解决成本低。</li>
</ul>
<p>与同类工具（如Ngrok）相比，FRP无需依赖第三方服务器，完全自主可控，尤其适合对隐私和稳定性要求较高的场景。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-适用场景"><strong>3. 适用场景</strong><a href="https://guru.kevin2li.top/blog/frp#3-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF" class="hash-link" aria-label="3-适用场景的直接链接" title="3-适用场景的直接链接">​</a></h4>
<p>FRP的典型应用场景包括但不限于：</p>
<ul>
<li>🌐 <strong>远程办公</strong>：在家访问公司内网的OA系统、数据库或开发环境。</li>
<li>🖥️ <strong>设备远程控制</strong>：通过SSH或远程桌面管理内网服务器/NAS。</li>
<li>🚀 <strong>本地开发调试</strong>：将本地的Web服务（如微信小程序后端）暴露至公网测试。</li>
<li>📡 <strong>物联网设备管理</strong>：远程访问家庭路由器、智能家居设备的控制界面。</li>
<li>🛡️ <strong>安全内网互通</strong>：通过加密隧道连接多地私有网络，替代传统VPN。</li>
</ul>
<p>无论你是开发者、运维工程师，还是普通用户，只需一台公网服务器，即可用FRP轻松实现“内外网无界访问”。接下来，我们将从零开始一步步完成FRP的部署与实战配置。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="二前置条件"><strong>二、前置条件</strong><a href="https://guru.kevin2li.top/blog/frp#%E4%BA%8C%E5%89%8D%E7%BD%AE%E6%9D%A1%E4%BB%B6" class="hash-link" aria-label="二前置条件的直接链接" title="二前置条件的直接链接">​</a></h3>
<p>在开始配置FRP之前，请确保满足以下基础条件：</p>
<ul>
<li>
<p><strong>✅ 公网服务器（服务端必备）</strong></p>
<ul>
<li><strong>最低配置要求</strong>：1核CPU / 1GB内存 （轻量级穿透足够）</li>
<li><strong>推荐选择</strong>：<a href="https://cloud.tencent.com/product/lighthouse" target="_blank" rel="noopener noreferrer">腾讯云轻量服务器</a>、<a href="https://www.aliyun.com/product/ecs" target="_blank" rel="noopener noreferrer">阿里云ECS</a> 或海外VPS（如BandwagonHost）</li>
<li><strong>操作系统</strong>：建议使用Linux（Ubuntu/CentOS），本教程以 <strong>Ubuntu 22.04</strong> 为例</li>
</ul>
</li>
<li>
<p><strong>✅ 内网客户端设备（被穿透的目标机器）</strong></p>
<ul>
<li><strong>设备类型</strong>：可以是Windows PC、Mac、Linux主机、树莓派、NAS等</li>
<li><strong>示例场景</strong>：<!-- -->
<ul>
<li>家中的Windows电脑（需远程桌面）</li>
<li>本地开发机的Web服务（如localhost:3000）</li>
<li>内网摄像头的监控端口</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>🌐 网络要求</strong>：</p>
<ul>
<li>客户端设备需能访问互联网（无需公网IP）</li>
<li>服务器必须开放 <strong>7000端口（FRP默认通信端口）</strong> 及后续映射的业务端口</li>
</ul>
</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="三frp核心概念"><strong>三、FRP核心概念</strong><a href="https://guru.kevin2li.top/blog/frp#%E4%B8%89frp%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5" class="hash-link" aria-label="三frp核心概念的直接链接" title="三frp核心概念的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-服务端frps与客户端frpc的关系"><strong>1. 服务端（frps）与客户端（frpc）的关系</strong><a href="https://guru.kevin2li.top/blog/frp#1-%E6%9C%8D%E5%8A%A1%E7%AB%AFfrps%E4%B8%8E%E5%AE%A2%E6%88%B7%E7%AB%AFfrpc%E7%9A%84%E5%85%B3%E7%B3%BB" class="hash-link" aria-label="1-服务端frps与客户端frpc的关系的直接链接" title="1-服务端frps与客户端frpc的关系的直接链接">​</a></h4>
<p>FRP采用<strong>客户端-服务端架构（C/S）</strong>，两者分工明确：</p>
<ul>
<li>
<p><strong>服务端（frps）</strong>：部署在<strong>公网服务器</strong>上，负责接收外部的访问请求，并通过预先建立的隧道将流量转发到对应的客户端。</p>
<ul>
<li>核心作用：<strong>流量中转枢纽</strong>，管理所有客户端连接。</li>
<li>典型配置：绑定端口（如<code>7000</code>）监听客户端连接。</li>
</ul>
</li>
<li>
<p><strong>客户端（frpc）</strong>：运行在<strong>内网设备</strong>上，主动向服务端发起连接，并声明需要暴露的本地服务（如SSH、Web服务）。</p>
<ul>
<li>核心作用：<strong>内网服务代理</strong>，将本地端口映射到公网。</li>
<li>典型配置：指定服务端IP、端口及本地服务规则。</li>
</ul>
</li>
</ul>
<p><strong>协作流程示例</strong>：</p>
<ol>
<li>客户端（frpc）与服务端（frps）建立控制通道（默认端口<code>7000</code>）。</li>
<li>当用户访问公网服务器的某个端口（如<code>8080</code>）时，服务端将请求通过隧道转发给客户端。</li>
<li>客户端将请求传递给内网服务（如本地的<code>localhost:3000</code>）。</li>
</ol>
<p>👉 <strong>类比理解</strong>：服务端像“接线员”，客户端像“分机号”，外网用户拨打总机号（公网IP+端口）即可转接到内网设备。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-核心概念关系图"><strong>2. 核心概念关系图</strong><a href="https://guru.kevin2li.top/blog/frp#2-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E5%85%B3%E7%B3%BB%E5%9B%BE" class="hash-link" aria-label="2-核心概念关系图的直接链接" title="2-核心概念关系图的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">外网用户 → 访问公网IP:Port → frps（服务端） → 隧道 → frpc（客户端） → 内网服务  </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>关键点</strong>：<!-- -->
<ul>
<li>客户端始终<strong>主动连接</strong>服务端，适合NAT穿透。</li>
<li>服务端不存储业务数据，仅负责流量转发。</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="四安装与配置"><strong>四、安装与配置</strong><a href="https://guru.kevin2li.top/blog/frp#%E5%9B%9B%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="四安装与配置的直接链接" title="四安装与配置的直接链接">​</a></h3>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>说明</div><div class="admonitionContent_BuS1"><p>简单起见，本教程使用Docker来进行frp的安装与配置，可参考<a href="https://docs.docker.com/engine/install/ubuntu/" target="_blank" rel="noopener noreferrer">Install Docker Engine on Ubuntu</a>教程进行Docker的安装。</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="服务端配置linux示例"><strong>服务端配置（Linux示例）</strong><a href="https://guru.kevin2li.top/blog/frp#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AElinux%E7%A4%BA%E4%BE%8B" class="hash-link" aria-label="服务端配置linux示例的直接链接" title="服务端配置linux示例的直接链接">​</a></h4>
<ol>
<li><strong>编写配置文件</strong></li>
</ol>
<p>创建<code>/etc/frp/frps.toml</code>配置文件，文件内容如下：</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">/etc/frp/frps.toml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">bindPort = 7000</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>该文件中指定了frp客户端与服务端通信的端口，默认为7000。</p>
<ol start="2">
<li><strong>防火墙放行端口</strong></li>
</ol>
<p>为了确保客户端和服务端能顺利建立连接，需要将云服务器的安全组和防火墙中将上一步骤指定的端口放行。</p>
<p>以下是阿里云服务中中"安全组"中放行端口的示例：</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20250201185427.png">
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>补充说明</div><div class="admonitionContent_BuS1"><p>如果你的服务器有另外安装防火墙服务，同样需要放行端口。以<code>firewalld</code>防火墙服务为例：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"># 查看当前防火墙配置</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo firewall-cmd --list-all </span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"># 添加放行端口</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo firewall-cmd --zone=public --permanent --add-port 7000/tcp</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo firewall-cmd --reload</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>
<ol start="3">
<li><strong>启动容器</strong></li>
</ol>
<p>编写docker-compose.yaml文件，内容如下：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">docker-compose.yaml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">frps</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> snowdreamtech/frps</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> frps</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">restart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> unless</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">stopped</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">network_mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> host</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"7000:7000"</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/etc/frp/frps.toml:/etc/frp/frps.toml"</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在与<code>docker-compose.yaml</code>同级目录下执行命令：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"># 启动容器</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">docker compose up -d</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用下面命令查看容器日志：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 查看容器日志</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker compose logs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>出现类似下面提示，表示启动成功。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20250201190341.png">
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="客户端配置linux示例"><strong>客户端配置（Linux示例）</strong><a href="https://guru.kevin2li.top/blog/frp#%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AElinux%E7%A4%BA%E4%BE%8B" class="hash-link" aria-label="客户端配置linux示例的直接链接" title="客户端配置linux示例的直接链接">​</a></h4>
<ol>
<li><strong>编写配置文件</strong></li>
</ol>
<p>创建<code>/etc/frp/frpc.toml</code>配置文件，文件内容如下：</p>
<div class="language-toml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">/etc/frp/frpc.toml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-toml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">serverAddr = "1.2.3.4" # 替换为自己服务器公网ip</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">serverPort = 7000</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">[[proxies]]</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">name = "ssh"</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">type = "tcp"</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">localIP = "127.0.0.1"</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">localPort = 22</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">remotePort = 22</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">[[proxies]]</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">name = "web"</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">type = "tcp"</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">localIP = "127.0.0.1"</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">localPort = 8080</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">remotePort = 8080</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪��贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>以上配置文件演示了ssh服务和web服务的端口转发。用户可以根据需要自行修改和添加更多配置。</p>
<ol start="2">
<li><strong>启动容器</strong></li>
</ol>
<p>编写docker-compose.yaml文件，内容如下：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">~/frpc/docker-compose.yaml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">frpc</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> snowdreamtech/frpc</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> frpc</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">restart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> unless</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">stopped</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">network_mode</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> host</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"/etc/frp/frpc.toml:/etc/frp/frpc.toml"</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在与<code>docker-compose.yaml</code>同级目录下执行命令：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain"># 启动容器</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">docker compose up -d</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用下面命令查看容器日志：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 查看容器日志</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">docker compose logs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>出现类似下面提示，表示启动成功。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20250201190642.png">
<p>这样，内网穿透的步骤就完成了，如果你配置无误的话，现在就可以直接在外部网络环境下访问内网的服务。</p>]]></content>
        <author>
            <name>Kevin2li</name>
            <uri>https://github.com/kevin2li</uri>
        </author>
        <category label="内网穿透" term="内网穿透"/>
        <category label="frp" term="frp"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Caddy自动HTTPS教程]]></title>
        <id>https://guru.kevin2li.top/blog/caddy</id>
        <link href="https://guru.kevin2li.top/blog/caddy"/>
        <updated>2024-09-22T12:41:17.000Z</updated>
        <summary type="html"><![CDATA[本期教程介绍如何使用Caddy实现网站的https访问。]]></summary>
        <content type="html"><![CDATA[<p>本期教程介绍如何使用<a href="https://caddyserver.com/" target="_blank" rel="noopener noreferrer">Caddy</a>实现网站的https访问。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><ol>
<li>本教程以<code>example.com</code>作为示例域名，用户需要自行将所有地方出现的<code>example.com</code>修改为自己的实际域名。</li>
<li>用户已经有一个云服务器，并且有一个可通过<strong>公网IP</strong>访问的网站，例如<code>http://1.2.3.4:5244</code>。</li>
</ol></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="域名购买">域名购买<a href="https://guru.kevin2li.top/blog/caddy#%E5%9F%9F%E5%90%8D%E8%B4%AD%E4%B9%B0" class="hash-link" aria-label="域名购买的直接链接" title="域名购买的直接链接">​</a></h2>
<p>为了使用https访问，你需要先申请一个域名，例如<code>example.com</code>。下面列举一些常用的域名服务提供商，用户可自行选择：</p>
<ul>
<li><a href="https://wanwang.aliyun.com/domain/tld#.com" target="_blank" rel="noopener noreferrer">阿里云</a></li>
<li><a href="https://cloud.tencent.com/act/pro/domain-sale?fromSource=gwzcw.7849480.7849480.7849480&amp;utm_medium=cpc&amp;utm_id=gwzcw.7849480.7849480.7849480&amp;msclkid=405dbe62d20917f3fc97d88c41562b59" target="_blank" rel="noopener noreferrer">腾讯云</a></li>
<li><a href="https://activity.huaweicloud.com/domain1.html?utm_source=bing&amp;utm_medium=se-cpc-op&amp;utm_campaign=&amp;utm_content=&amp;utm_term=%E5%9F%9F%E5%90%8D%E8%B4%AD%E4%B9%B0&amp;utm_adplace=AdPlace088896&amp;msclkid=853d1490e03d195a05fd727e73625d9a" target="_blank" rel="noopener noreferrer">华为云</a></li>
<li>...</li>
</ul>
<p>一般建议你的云服务器是哪家的，就选择哪家的域名服务。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="域名解析">域名解析<a href="https://guru.kevin2li.top/blog/caddy#%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90" class="hash-link" aria-label="域名解析的直接链接" title="域名解析的直接链接">​</a></h2>
<p>域名购买后，可以在<strong>域名控制台</strong>中将域名解析到你的云服务器的<strong>公网IP</strong>上。</p>
<p>例如将<code>alist.example.com</code>解析到你的公网IP上。</p>
<p>这里以阿里云为例，演示如何添加域名解析记录。</p>
<p>打开云解析DNS控制台，点击『添加记录』按钮。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240922004946.png">
<p>添加A类型解析记录,记录值填写公网IP。</p>
<div style="text-align:center;border:1px solid #eee"><img src="https://minio.kevin2li.site/image-bed/wiki/20240922004623.png"></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="域名备案">域名备案<a href="https://guru.kevin2li.top/blog/caddy#%E5%9F%9F%E5%90%8D%E5%A4%87%E6%A1%88" class="hash-link" aria-label="域名备案的直接链接" title="域名备案的直接链接">​</a></h2>
<p>为了能够正常通过域名访问你的网站或服务，你还需要经过<strong>ICP备案</strong>和<strong>公安备案</strong>，如实填写你的网站用途、负责人等信息。备案通过后才能正常使用域名。详细步骤可以咨询你的域名服务提供商。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="反向代理">反向代理<a href="https://guru.kevin2li.top/blog/caddy#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86" class="hash-link" aria-label="反向代理的直接链接" title="反向代理的直接链接">​</a></h2>
<p>反向代理，区别于一般意义上的代理(即作为客户端的代理)，反向代理是对服务端的代理。</p>
<p>前面我们已经实现直接通过<strong>公网IP</strong>的方式访问web服务,例如<code>http://server-ip:5244</code>。为了实现域名访问，还需要配置下反向代理，将对域名的访问请求转发到主机对应端口提供的服务中去。</p>
<p>我们使用<a href="https://caddyserver.com/" target="_blank" rel="noopener noreferrer">Caddy</a>工具来配置反向代理。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240922123833.png">
<p>要实现<strong>https</strong>访问，需要有域名证书。Caddy支持自动从<a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">Let's Encrypt</a>或<a href="https://zerossl.com/" target="_blank" rel="noopener noreferrer">ZeroSSL</a>申请、配置和续期免费的域名证书，比较方便。当然如果你已经有了域名证书，也可以在Caddy中直接指定。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>说明</div><div class="admonitionContent_BuS1"><p>本教程使用的TLS配置为<a href="https://ssl-config.mozilla.org/" target="_blank" rel="noopener noreferrer">Mozilla SSL Configuration Generator</a>生成的<code>Intermediate</code>级别配置，适用于绝大部分场景。</p></div></div>
<p>Caddy支持多种自动申请证书的方式，详见：<a href="https://caddyserver.com/docs/automatic-https" target="_blank" rel="noopener noreferrer">Automatically HPPS | Caddy</a>。</p>
<p>这里介绍最常用的两种方式：<strong>HTTP challenge</strong>和<strong>DNS challenge</strong>。用户选择其中一种即可，推荐使用前者更简单方便。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用http-challenge自动申请证书推荐">使用HTTP challenge自动申请证书(推荐)<a href="https://guru.kevin2li.top/blog/caddy#%E4%BD%BF%E7%94%A8http-challenge%E8%87%AA%E5%8A%A8%E7%94%B3%E8%AF%B7%E8%AF%81%E4%B9%A6%E6%8E%A8%E8%8D%90" class="hash-link" aria-label="使用HTTP challenge自动申请证书(推荐)的直接链接" title="使用HTTP challenge自动申请证书(推荐)的直接链接">​</a></h3>
<p>此方式需要开放服务器的80和443端口。可以在云服务器控制台的<strong>安全组管理</strong>中确认是否已放行80和443端口。</p>
<details open="" class="details_lb9f alert alert--info details_b_Ee" data-collapsed="false"><summary>查看详情</summary><div><div class="collapsibleContent_i85q"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="安装caddy">安装Caddy<a href="https://guru.kevin2li.top/blog/caddy#%E5%AE%89%E8%A3%85caddy" class="hash-link" aria-label="安装Caddy的直接链接" title="安装Caddy的直接链接">​</a></h4><p>在终端中依次输入下面命令：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo apt install -y debian-keyring debian-archive-keyring apt-transport-https curl</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt' | sudo tee /etc/apt/sources.list.d/caddy-stable.list</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo apt update</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo apt install caddy</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>验证安装成功</strong></p><p>终端中输入下面命令:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">caddy version</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>出现类似下面提示，表示安装成功。</p><img src="https://minio.kevin2li.site/image-bed/wiki/20240922002445.png"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="配置反向代理">配置反向代理<a href="https://guru.kevin2li.top/blog/caddy#%E9%85%8D%E7%BD%AE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86" class="hash-link" aria-label="配置反向代理的直接链接" title="配置反向代理的直接链接">​</a></h4><p><strong>编写Caddyfile</strong></p><p>终端中依次输入下面命令，创建一个<code>Caddyfile</code>文件</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo rm -rf /etc/caddy/Caddyfile</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo vi /etc/caddy/Caddyfile</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>文件内容如下：</p><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>将下面文件中的<code>email</code>和<code>example.com</code>替换为你的实际邮箱和实际域名。</p></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7"> /etc/caddy/Caddyfile</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">{</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    email you@yours.com</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">}</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">*.example.com, example.com  {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    header {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        Strict-Transport-Security "max-age=63072000"</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    tls {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        protocols tls1.2 tls1.3</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        ciphers TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    @alist host alist.example.com</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    handle @alist {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        reverse_proxy 127.0.0.1:5244</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        encode zstd gzip</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    handle {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        abort</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">}</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>VI编辑器使用说明</div><div class="admonitionContent_BuS1"><p>输入<code>i</code>进入输入模式，粘贴上面的内容，然后按<code>ESC</code>回到正常模式，输入<code>:wq</code>即可退出并保存文件。</p></div></div><p><strong>重启服务</strong></p><p>终端中输入下面命令：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo systemctl restart caddy</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo systemctl status caddy</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当出现类似下面提示，说明证书申请成功。</p><img src="https://minio.kevin2li.site/image-bed/wiki/20240922110405.png"><p>然后可以浏览器通过域名访问网站测试下，例如访问<code>https://alist.example.com</code>, 第一次申请证书可能要等几分钟才能正常访问。</p></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用dns-challenge自动申请证书">使用DNS challenge自动申请证书<a href="https://guru.kevin2li.top/blog/caddy#%E4%BD%BF%E7%94%A8dns-challenge%E8%87%AA%E5%8A%A8%E7%94%B3%E8%AF%B7%E8%AF%81%E4%B9%A6" class="hash-link" aria-label="使用DNS challenge自动申请证书的直接链接" title="使用DNS challenge自动申请证书的直接链接">​</a></h3>
<p>此方式需要去域名提供商获取DNS的API密钥。</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>查看详情</summary><div><div class="collapsibleContent_i85q"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="安装caddy-1">安装Caddy<a href="https://guru.kevin2li.top/blog/caddy#%E5%AE%89%E8%A3%85caddy-1" class="hash-link" aria-label="安装Caddy的直接链接" title="安装Caddy的直接链接">​</a></h4><p>可以去<a href="https://caddyserver.com/download" target="_blank" rel="noopener noreferrer">Caddy官网</a>上下载二进制可执行文件。</p><p>如果你使用的是腾讯云、阿里云等域名提供商，需要下载安装集成了对应插件版本的Caddy。</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">腾讯云域名</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">阿里云域名</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><img src="https://minio.kevin2li.site/image-bed/wiki/20240921235754.png"></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><img src="https://minio.kevin2li.site/image-bed/wiki/20240921235949.png"></div></div></div><p>方便起见，这里也提供了集成了腾讯云和阿里云插件的Caddy版本下载：<a href="https://pan.baidu.com/s/1Nyz54SWTzFqkBPuLDz8diw?pwd=dm2j" target="_blank" rel="noopener noreferrer">Caddy_linux_amd64_dnspod_alidns | 百度云</a></p><p>下载好后，将文件上传至云服务器,并重命名为<code>caddy</code>。</p><p>然后在终端中依次输入下面命令；</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo mv /path/to/caddy /usr/bin # 注意将前面的路径替换为你实际的Caddy路径</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo chmod +x /usr/bin/caddy</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>验证安装成功</strong></p><p>终端中输入下面命令:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">caddy version</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>出现类似下面提示，表示安装成功。</p><img src="https://minio.kevin2li.site/image-bed/wiki/20240922002445.png"><p><strong>设置为系统服务</strong></p><p>创建caddy用户组和用户。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo groupadd --system caddy</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo useradd --system \</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    --gid caddy \</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    --create-home \</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    --home-dir /var/lib/caddy \</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    --shell /usr/sbin/nologin \</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    --comment "Caddy web server" \</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    caddy</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>编写服务文件。</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo vi /etc/systemd/system/caddy.service</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>文件内容如下：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">[Unit]</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Description=Caddy</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Documentation=https://caddyserver.com/docs/</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">After=network.target network-online.target</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Requires=network-online.target</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">[Service]</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Type=notify</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">User=caddy</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">Group=caddy</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ExecStart=/usr/bin/caddy run --environ --config /etc/caddy/Caddyfile</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ExecReload=/usr/bin/caddy reload --config /etc/caddy/Caddyfile --force</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">TimeoutStopSec=5s</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">LimitNOFILE=1048576</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">PrivateTmp=true</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">ProtectSystem=full</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">AmbientCapabilities=CAP_NET_ADMIN CAP_NET_BIND_SERVICE</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">[Install]</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">WantedBy=multi-user.target</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>VI编辑器使用说明</div><div class="admonitionContent_BuS1"><p>输入<code>i</code>进入输入模式，粘贴上面的内容，然后按<code>ESC</code>回到正常模式，输入<code>:wq</code>即可退出并保存文件。</p></div></div><p><strong>重载系统服务</strong></p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo systemctl daemon-reload</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo systemctl enable --now caddy</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo systemctl status caddy</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当出现类似下面提示，说明安装成功。</p><img src="https://minio.kevin2li.site/image-bed/wiki/20240922004108.png"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="配置反向代理-1">配置反向代理<a href="https://guru.kevin2li.top/blog/caddy#%E9%85%8D%E7%BD%AE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86-1" class="hash-link" aria-label="配置反向代理的直接链接" title="配置反向代理的直接链接">​</a></h4><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">腾讯云域名</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">阿里云域名</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p><strong>获取DNS访问密钥</strong></p><blockquote>
<p>参考：<a href="https://support.dnspod.cn/account/dnspod-token/" target="_blank" rel="noopener noreferrer">https://support.dnspod.cn/account/dnspod-token/</a></p>
</blockquote><p>登录<a href="https://console.dnspod.cn/account" target="_blank" rel="noopener noreferrer">DNSPod 账号中心控制台</a>，依次单击<strong>账号中心-&gt;密钥管理</strong>。</p><p>在密钥管理控制台中，单击创建密钥。如下图所示。</p><div style="text-align:center;border:1px solid #eee"><img src="https://minio.kevin2li.site/image-bed/wiki/20240922174358.png"></div><p>保管好生成的<code>ID</code>和<code>Token</code>，后面会用到。</p><div style="text-align:center;border:1px solid #eee"><img src="https://minio.kevin2li.site/image-bed/wiki/20240922174451.png" width="85%"></div><p><strong>编写Caddyfile</strong></p><blockquote>
<p>参考链接：<a href="https://github.com/caddy-dns/dnspod" target="_blank" rel="noopener noreferrer">https://github.com/caddy-dns/dnspod</a></p>
</blockquote><p>终端中依次输入下面命令，创建一个<code>Caddyfile</code>文件</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo rm -rf /etc/caddy/Caddyfile</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo vi /etc/caddy/Caddyfile</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>文件内容如下：</p><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>将下面文件中的</p><ul>
<li><code>email</code>和<code>example.com</code>替换为你的实际邮箱和实际域名。</li>
<li><code>DNSPOD_TOKEN</code>替换为你的实际密钥，格式为：<code>ID,Token</code>。<!-- -->
<ul>
<li>例如ID为<code>13490</code>,ToKen为<code>6b5976c68aba5b14a0558b77c17c3932</code>，则<code>DNSPOD_TOKEN</code> 为<code>13490,6b5976c68aba5b14a0558b77c17c3932</code></li>
</ul>
</li>
</ul></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7"> /etc/caddy/Caddyfile</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">{</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    email you@yours.com</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">}</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">*.example.com, example.com  {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    header {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        Strict-Transport-Security "max-age=63072000"</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    tls {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        protocols tls1.2 tls1.3</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        ciphers TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        dns dnspod DNSPOD_TOKEN</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    @alist host alist.example.com</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    handle @alist {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        reverse_proxy 127.0.0.1:5244</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        encode zstd gzip</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    handle {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        abort</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">}</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>VI编辑器使用说明</div><div class="admonitionContent_BuS1"><p>输入<code>i</code>进入输入模式，粘贴上面的内容，然后按<code>ESC</code>回到正常模式，输入<code>:wq</code>即可退出并保存文件。</p></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p><strong>获取DNS访问密钥</strong></p><p>登录<a href="https://home.console.aliyun.com/" target="_blank" rel="noopener noreferrer">阿里云控制台</a>，点击右上角头像，进入<code>AccessKey管理</code>菜单。</p><div style="text-align:center;border:1px solid #eee"><img src="https://minio.kevin2li.site/image-bed/wiki/20240921210049.png" width="50%"></div><p>点击"创建AccessKey"按钮。</p><img src="https://minio.kevin2li.site/image-bed/wiki/20240921210438.png"><p>保管好生成的<code>AccessKey ID</code>和<code>AccessKey Secret</code>，后面会用到。</p><div style="text-align:center;border:1px solid #eee"><img src="https://minio.kevin2li.site/image-bed/wiki/20240921211054.png" width="85%"></div><p><strong>编写Caddyfile</strong></p><blockquote>
<p>参考链接：<a href="https://github.com/caddy-dns/alidns" target="_blank" rel="noopener noreferrer">https://github.com/caddy-dns/alidns</a></p>
</blockquote><p>终端中依次输入下面命令，创建一个<code>Caddyfile</code>文件</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo rm -rf /etc/caddy/Caddyfile</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo vi /etc/caddy/Caddyfile</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>文件内容如下：</p><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>将下面文件中的</p><ul>
<li><code>email</code>和<code>example.com</code>替换为你的实际邮箱和实际域名。</li>
<li><code>ALIYUN_ACCESS_KEY_ID</code>和<code>ALIYUN_ACCESS_KEY_SECRET</code>分别替换为你的<code>AccessKey ID</code>和<code>AccessKey Secret</code></li>
</ul></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7"> /etc/caddy/Caddyfile</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">{</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    email you@yours.com</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">}</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">*.example.com, example.com {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    header {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        Strict-Transport-Security "max-age=63072000"</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    tls {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        protocols tls1.2 tls1.3</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        ciphers TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        dns alidns {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            access_key_id ALIYUN_ACCESS_KEY_ID</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">            access_key_secret ALIYUN_ACCESS_KEY_SECRET</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    @alist host alist.example.com</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    handle @alist {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        reverse_proxy 127.0.0.1:5244</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        encode zstd gzip</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    handle {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        abort</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">}</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>VI编辑器使用说明</div><div class="admonitionContent_BuS1"><p>输入<code>i</code>进入输入模式，粘贴上面的内容，然后按<code>ESC</code>回到正常模式，输入<code>:wq</code>即可退出并保存文件。</p></div></div></div></div></div><p><strong>重启服务</strong></p><p>终端中输入下面命令：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo systemctl restart caddy</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo systemctl status caddy</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当出现类似下面提示，说明证书申请成功。</p><img src="https://minio.kevin2li.site/image-bed/wiki/20240922110405.png"><p>然后可以浏览器通过域名访问网站测试下，例如访问<code>https://alist.example.com</code>, 第一次申请证书可能要等几分钟才能正常访问。</p></div></div></details>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="手动指定证书">手动指定证书<a href="https://guru.kevin2li.top/blog/caddy#%E6%89%8B%E5%8A%A8%E6%8C%87%E5%AE%9A%E8%AF%81%E4%B9%A6" class="hash-link" aria-label="手动指定证书的直接链接" title="手动指��定证书的直接链接">​</a></h3>
<p>如果你已经有了域名证书，也可以直接指定使用你的证书。</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>查看详情</summary><div><div class="collapsibleContent_i85q"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="安装caddy-2">安装Caddy<a href="https://guru.kevin2li.top/blog/caddy#%E5%AE%89%E8%A3%85caddy-2" class="hash-link" aria-label="安装Caddy的直接链接" title="安装Caddy的直接链接">​</a></h4><p>在终端中依次输入下面命令：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo apt install -y debian-keyring debian-archive-keyring apt-transport-https curl</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt' | sudo tee /etc/apt/sources.list.d/caddy-stable.list</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo apt update</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo apt install caddy</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>验证安装成功</strong></p><p>终端中输入下面命令:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">caddy version</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>出现类似下面提示，表示安装成功。</p><img src="https://minio.kevin2li.site/image-bed/wiki/20240922002445.png"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="配置反向代理-2">配置反向代理<a href="https://guru.kevin2li.top/blog/caddy#%E9%85%8D%E7%BD%AE%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86-2" class="hash-link" aria-label="配置反向代理的直接链接" title="配置反向代理的直接链接">​</a></h4><p><strong>编写Caddyfile</strong></p><p>终端中依次输入下面命令，创建一个<code>Caddyfile</code>文件</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo rm -rf /etc/caddy/Caddyfile</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo vi /etc/caddy/Caddyfile</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>文件内容如下：</p><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>将下面文件中的</p><ul>
<li><code>email</code>和<code>example.com</code>替换为你的实际邮箱和实际域名。</li>
<li><code>&lt;your_cert.pem&gt;</code>和<code>&lt;your_key.pem&gt;</code>分别替换为你的证书路径和密钥路径。</li>
</ul></div></div><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7"> /etc/caddy/Caddyfile</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">{</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    email you@yours.com</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">}</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain" style="display:inline-block"></span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">*.example.com, example.com {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    header {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        Strict-Transport-Security "max-age=63072000"</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    tls &lt;your_cert.pem&gt; &lt;your_key.pem&gt; {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        protocols tls1.2 tls1.3</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        ciphers TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256 TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    @alist host alist.example.com</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    handle @alist {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        reverse_proxy 127.0.0.1:5244</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        encode zstd gzip</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    handle {</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">        abort</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">    }</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">}</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>VI编辑器使用说明</div><div class="admonitionContent_BuS1"><p>输入<code>i</code>进入输入模式，粘贴上面的内容，然后按<code>ESC</code>回到正常模式，输入<code>:wq</code>即可退出并保存文件。</p></div></div><p><strong>重启服务</strong></p><p>终端中输入下面命令：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv codeBlockLinesWithNumbering_o6Pm"><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo systemctl restart caddy</span></span><br></span><span class="token-line codeLine_lJS_" style="color:#393A34"><span class="codeLineNumber_Tfdd"></span><span class="codeLineContent_feaV"><span class="token plain">sudo systemctl status caddy</span></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>当出现类似下面提示，说明证书申请成功。</p><img src="https://minio.kevin2li.site/image-bed/wiki/20240922110405.png"><p>然后可以浏览器通过域名访问网站测试下，例如访问<code>https://alist.example.com</code>, 第一次申请证书可能要等几分钟才能正常访问。</p></div></div></details>]]></content>
        <author>
            <name>Kevin2li</name>
            <uri>https://github.com/kevin2li</uri>
        </author>
        <category label="教程" term="教程"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Word和WPS中如何编号自动转纯文本]]></title>
        <id>https://guru.kevin2li.top/blog/word_num2txt</id>
        <link href="https://guru.kevin2li.top/blog/word_num2txt"/>
        <updated>2024-08-10T02:52:21.000Z</updated>
        <summary type="html"><![CDATA[背景]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="背景">背景<a href="https://guru.kevin2li.top/blog/word_num2txt#%E8%83%8C%E6%99%AF" class="hash-link" aria-label="背景的直接链接" title="背景的直接链接">​</a></h2>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>为什么有这个需求？</div><div class="admonitionContent_BuS1"><p>在<a href="https://guru.kevin2li.top/docs/word-card">Word制卡</a>中，不管是问答题或填空题，有时需要根据正则匹配来分隔卡片，如果列表不转成纯文本格式，可能会导致正则匹配失败。</p></div></div>
<p>下图是Word或WPS中设置的列表格式，当点击任何一个列表序号，其他列表序号都会一起高亮显示出来。</p>
<img src="https://minio.kevin2li.site/image-bed/blog/202408100935232.gif">
<img-annotation>Word列表编号</img-annotation>
<p>现在需求是把这些列表编号转换成普通的纯文本格式，点击任一编号互相之间没有关联。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="教程">教程<a href="https://guru.kevin2li.top/blog/word_num2txt#%E6%95%99%E7%A8%8B" class="hash-link" aria-label="教程的直接链接" title="教程的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="word操作指南">Word操作指南<a href="https://guru.kevin2li.top/blog/word_num2txt#word%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97" class="hash-link" aria-label="Word操作指南的直接链接" title="Word操作指南的直接链接">​</a></h3>
<ol>
<li><strong>启用『开发工具』</strong></li>
</ol>
<p>打开<code>文件-&gt;选项-&gt;自定义功能区-&gt;勾选『开发工具』-&gt;确定</code>。</p>
<img src="https://minio.kevin2li.site/image-bed/blog/202408100943639.png">
<img-annotation>文件&gt;选项</img-annotation>
<img src="https://minio.kevin2li.site/image-bed/blog/202408100929266.png">
<img-annotation>勾选『开发工具』</img-annotation>
<ol start="2">
<li><strong>编写宏</strong></li>
</ol>
<img src="https://minio.kevin2li.site/image-bed/blog/202408100948231.png">
<img-annotation>打开宏</img-annotation>
<img src="https://minio.kevin2li.site/image-bed/blog/202408100949267.png">
<img-annotation>创建宏</img-annotation>
<p>宏代码：</p>
<div class="language-vb codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-vb codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ActiveDocument.Content.ListFormat.ConvertNumbersToText</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将上面的宏代码粘贴进编辑窗口中，然后保存，关闭窗口。</p>
<img src="https://minio.kevin2li.site/image-bed/blog/202408100951162.png">
<ol start="3">
<li><strong>运行宏</strong></li>
</ol>
<p>打开需要列表转纯文本的文档，然后按下图所示运行宏。</p>
<img src="https://minio.kevin2li.site/image-bed/blog/202408100954406.png">
<img-annotation>运行宏</img-annotation>
<p>运行结束后，原有列表编号就变成了纯文本格式。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wps操作指南">WPS操作指南<a href="https://guru.kevin2li.top/blog/word_num2txt#wps%E6%93%8D%E4%BD%9C%E6%8C%87%E5%8D%97" class="hash-link" aria-label="WPS操作指南的直接链接" title="WPS操作指南的直接链接">​</a></h3>
<p>WPS中的操作也基本类似。</p>
<ol>
<li><strong>编写宏</strong></li>
</ol>
<img src="https://minio.kevin2li.site/image-bed/blog/202408101000919.png">
<p>宏代码：</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> doc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">ActiveDocument</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">doc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Content</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">ListFormat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">ConvertNumbersToText</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将上面的宏代码粘贴进宏编辑器窗口的函数块内。</p>
<img src="https://minio.kevin2li.site/image-bed/blog/202408101003856.png">
<ol start="2">
<li><strong>运行宏</strong></li>
</ol>
<img src="https://minio.kevin2li.site/image-bed/blog/202408101005717.png">
<p>运行结束后，原有列表编号就变成了纯文本格式。</p>]]></content>
        <author>
            <name>Kevin2li</name>
            <uri>https://github.com/kevin2li</uri>
        </author>
        <category label="办公" term="办公"/>
        <category label="教程" term="教程"/>
        <category label="Word" term="Word"/>
        <category label="WPS" term="WPS"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[自建Bitwarden密码管理服务器]]></title>
        <id>https://guru.kevin2li.top/blog/bitwarden</id>
        <link href="https://guru.kevin2li.top/blog/bitwarden"/>
        <updated>2024-08-10T02:52:21.000Z</updated>
        <summary type="html"><![CDATA[背景]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="背景">背景<a href="https://guru.kevin2li.top/blog/bitwarden#%E8%83%8C%E6%99%AF" class="hash-link" aria-label="背景的直接链接" title="背景的直接链接">​</a></h2>
<p>最近登录Github时发现，Github开始要求用户开启<strong>双因素认证</strong>(two-factor authentication, 2FA)了。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240808161016.png">
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>科普 | 什么是双因素认证？</div><div class="admonitionContent_BuS1"><p>双因素认证，就是登录或者做某些操作时，除了需要输入密码（第一因素，你知道的东西），还需要第二个东西来证明你是你。这个第二个东西可以是：</p><ol>
<li><strong>手机或硬件令牌上的一个临时验证码</strong>（你拥有的东西）：每次登录时，手机上的一个特定应用会生成一个只有几分钟有效的新数字，你把这个数字输入进去，系统才会让你登录。</li>
<li><strong>指纹或面部识别</strong>（你是什么）：这是更高级的认证方式，你的生物特征就是第二因素。</li>
</ol><p>简单来说，双因素认证就像是银行的安全门，密码是第一道门，你还得用第二把钥匙（比如手机上的验证码）才能完全打开门进去。这样即使有人知道了你的密码，没有第二把钥匙，也进不了门。这就是为什么双因素认证能大大提高账户安全性的原因。</p></div></div>
<p>根据Github上面的提示，推荐用户使用<a href="https://support.1password.com/one-time-passwords/" target="_blank" rel="noopener noreferrer">1Password</a>、<a href="https://authy.com/guides/github/" target="_blank" rel="noopener noreferrer">Authy</a>、<a href="https://www.microsoft.com/en-us/security/mobile-authenticator-app" target="_blank" rel="noopener noreferrer">Microsoft Authenticator</a>等密码管理软件生成一次性密码来作为第二因素。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240808160132.png">
<p>但是上面这些软件我尝试了一下要么是付费软件，要么就是所在地区无法使用，总之就是很不方便，也没能设置成功。</p>
<p>后来了解到一个开源的密码管理软件<a href="https://bitwarden.com/blog/secure-github-with-bitwarden/" target="_blank" rel="noopener noreferrer">Bitwarden</a>似乎也可以，然而要使用双因素认证功能还需要购买会员。不过，由于它是开源软件，支持用户在自己服务器上部署，便可绕过它的收费服务。</p>
<p>下面记录一下搭建教程。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="安装bitwarden-server">安装Bitwarden Server<a href="https://guru.kevin2li.top/blog/bitwarden#%E5%AE%89%E8%A3%85bitwarden-server" class="hash-link" aria-label="安装Bitwarden Server的直接链接" title="安装Bitwarden Server的直接链接">​</a></h2>
<p>首先，Bitwarden有官方的Docker部署指南，详细可以参考：<a href="https://bitwarden.com/help/install-on-premise-linux/" target="_blank" rel="noopener noreferrer">Bitwarden Self-hosting | Linux Standard Deployment</a>。</p>
<p>但是官方提供的方案对服务器要求比较高，消耗系统资源比较大，属于重量级方案，这里没有采用。</p>
<p>然后发现有个非官方的使用<code>Rust</code>实现的Bitwarden Server平替方案<a href="https://github.com/dani-garcia/vaultwarden" target="_blank" rel="noopener noreferrer">vaultwarden</a>, 对系统资源消耗小，并且Bitwarden的几乎全部功能都有，因此这里采用的是它的方案。</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>这里主要使用Docker进行部署，用户需要事先安装好<a href="https://docs.docker.com/engine/install/ubuntu/" target="_blank" rel="noopener noreferrer">Docker</a>。</p></div></div>
<ol>
<li>拉取<code>vaultwarden</code>容器镜像：</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker pull vaultwarden/server:latest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>编写<code>docker-compose.yaml</code></li>
</ol>
<p>新建一个空文件夹，里面创建一个<code>docker-compose.yaml</code>文件，内容如下：</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">version</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'3.9'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">services</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">vaultwarden</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">container_name</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> vaultwarden</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">image</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> vaultwarden/server</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">ports</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"8000:80"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">volumes</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"./vw-data/:/data/"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token key atrule" style="color:#00a4db">restart</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'always'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>启动容器：</li>
</ol>
<p>在和<code>docker-compose.yaml</code>文件同级目录下执行下面命令。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker compose up -d</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>浏览器中输入服务器地址访问：<code>http://&lt;your-server-ip&gt;:8000</code></p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240808164620.png">
<p>能正常打开网页表示启动成功。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="公网访问">公网访问<a href="https://guru.kevin2li.top/blog/bitwarden#%E5%85%AC%E7%BD%91%E8%AE%BF%E9%97%AE" class="hash-link" aria-label="公网访问的直接链接" title="公网访问的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="内网穿透">内网穿透<a href="https://guru.kevin2li.top/blog/bitwarden#%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F" class="hash-link" aria-label="内网穿透的直接链接" title="内网穿透的直接链接">​</a></h3>
<p>由于我把bitwarden服务部署在了本地的服务器，只有与本地服务器同一局域网下的设备能访问。为了能在公网环境下使用，还需要设置一下内网穿透。</p>
<p>首先你要有一台自己的云服务器，然后在云服务器和本地服务器都要安装对应的内网穿透软件，如<a href="https://github.com/fatedier/frp" target="_blank" rel="noopener noreferrer">frp</a>等等。</p>
<p>然后经过一些配置，最终实现将云服务器的指定端口和本地服务器的bitwarden服务端口建立隧道, 具体可以参考你使用内网穿透软件的使用教程。</p>
<p>这个步骤做完，应该可以通过云服务器的IP地址来访问位于内网中的<code>Bitwarden</code>服务了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="反向代理">反向代理<a href="https://guru.kevin2li.top/blog/bitwarden#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86" class="hash-link" aria-label="反向代理的直接链接" title="反向代理的直接链接">​</a></h3>
<p>这步的目的是为了能够使用<code>域名访问</code>和<code>https访问</code>。这个环节涉及到<strong>域名注册</strong>、<strong>域名备案</strong>、<strong>SSL证书申请</strong>等步骤，有机会单独出教程。</p>
<p>本教程使用<code>nginx</code>做反向代理，假设你已经完成了上面步骤，然后就可以在<code>nginx</code>配置文件(一般为<code>/etc/nginx/nginx.conf</code>)中添加新服务器。</p>
<p>假设你的域名是<code>bitwarden.example.com</code>, 配置中可添加下面内容：</p>
<div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># bitwarden</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server_name bitwarden.example.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    listen 443 ssl http2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ssl_certificate &lt;替换为你的证书路径&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ssl_certificate_key &lt;替换为你的密钥路径&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # listen 80 default;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ($scheme = http) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 301 https://$host:443$request_uri;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 反向代理</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_pass http://127.0.0.1:8000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header Host $host;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header X-Real-IP $remote_addr;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header X-Forwarded-Host $http_host;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header X-Forwarded-Port $server_port;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header X-Forwarded-Proto $scheme;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header Upgrade $http_upgrade;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header Connection upgrade;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header Accept-Encoding gzip;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_redirect http:// https://;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>重启<code>nginx</code>服务:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo ngins -s reload</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>正常情况下，此时已经可以通过域名<code>https://bitwarden.example.com</code>访问服务了。</p>]]></content>
        <author>
            <name>Kevin2li</name>
            <uri>https://github.com/kevin2li</uri>
        </author>
        <category label="教程" term="教程"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Anki图床搭建教程]]></title>
        <id>https://guru.kevin2li.top/blog/imagebed</id>
        <link href="https://guru.kevin2li.top/blog/imagebed"/>
        <updated>2024-07-31T13:03:16.000Z</updated>
        <summary type="html"><![CDATA[本期介绍一下Anki图床的搭建教程。]]></summary>
        <content type="html"><![CDATA[<p>本期介绍一下Anki图床的搭建教程。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>背景</div><div class="admonitionContent_BuS1"><p>由于Ankiweb的同步速度较慢，尤其在牌组内图片较多的时候同步需要花费很长时间，严重影响学习体验。搭建图床的目的主要是为了将图片数据转为文本形式的URL，可以大大减小牌组体积，从而方便快速同步。</p></div></div>
<p>本教程使用<a href="https://github.com/Molunerfinn/PicGo" target="_blank" rel="noopener noreferrer">PicGo</a>作为图床管理工具，<a href="https://www.aliyun.com/product/oss" target="_blank" rel="noopener noreferrer">阿里云OSS</a>作为图床存储服务，<a href="https://guru.kevin2li.top/" target="_blank" rel="noopener noreferrer">PDF Guru Anki</a>自动批量上传图片到图床。</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>科普</div><div class="admonitionContent_BuS1"><p><a href="https://github.com/Molunerfinn/PicGo" target="_blank" rel="noopener noreferrer">PicGo</a>是一个开源易用的图床管理软件，可以快速上传图片并获取图片URL，支持<a href="https://sm.ms/" target="_blank" rel="noopener noreferrer">SM.MS</a>、<a href="https://www.aliyun.com/product/oss" target="_blank" rel="noopener noreferrer">阿里云OSS</a>、<a href="https://cloud.tencent.com/product/cos" target="_blank" rel="noopener noreferrer">腾讯云COS</a>、<a href="https://github.com/" target="_blank" rel="noopener noreferrer">Github</a>等多款流行图床服务，截止2024年7月，Github星标已经超过23k。</p><p>Github地址：<a href="https://github.com/Molunerfinn/PicGo" target="_blank" rel="noopener noreferrer">https://github.com/Molunerfinn/PicGo</a></p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="picgo下载与安装">Picgo下载与安装<a href="https://guru.kevin2li.top/blog/imagebed#picgo%E4%B8%8B%E8%BD%BD%E4%B8%8E%E5%AE%89%E8%A3%85" class="hash-link" aria-label="Picgo下载与安装的直接链接" title="Picgo下载与安装的直接链接">​</a></h2>
<p>首先，需要下载安装PicGo。用户可以去PicGo的官方<a href="https://github.com/Molunerfinn/PicGo/releases/tag/v2.3.1" target="_blank" rel="noopener noreferrer">Github</a>自行下载最新版安装包。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731145023.png">
<img-annotation>Win用户下载PicGo</img-annotation>
<p>如果由于网络原因导致无法下载，这里也提供了网盘下载：<a href="https://pan.baidu.com/s/1CUs2r-ZN1FUIiZbp8G_-gQ?pwd=fprs" target="_blank" rel="noopener noreferrer">百度网盘</a>。</p>
<p>安装完成后，打开应该能看到如下界面。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731145848.png">
<img-annotation>PicGo主页面</img-annotation>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="阿里云图床配置">阿里云图床配置<a href="https://guru.kevin2li.top/blog/imagebed#%E9%98%BF%E9%87%8C%E4%BA%91%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE" class="hash-link" aria-label="阿里云图床配置的直接链接" title="阿里云图床配置的直接链接">​</a></h2>
<p>PicGo主体支持阿里云OSS、腾讯云COS、Github等多种图床服务，如果需要其他图床也支持通过插件的方式实现。</p>
<p>本教程使用<a href="https://www.aliyun.com/product/oss" target="_blank" rel="noopener noreferrer">阿里云OSS</a>作为图床服务。</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>科普</div><div class="admonitionContent_BuS1"><p>阿里云OSS, 全称"阿里云对象存储 OSS（Object Storage Service）"，是一款海量、安全、低成本、高可靠的云存储服务，提供最高可达 99.995 % 的服务可用性。多种存储类型供选择。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="购买资源包">购买资源包<a href="https://guru.kevin2li.top/blog/imagebed#%E8%B4%AD%E4%B9%B0%E8%B5%84%E6%BA%90%E5%8C%85" class="hash-link" aria-label="购买资源包的直接链接" title="购买资源包的直接链接">​</a></h3>
<p>首先需要去<a href="https://common-buy.aliyun.com/?spm=a2c4g.11186623.0.0.28c11887AxDVos&amp;commodityCode=ossbag&amp;request=%7B%22region%22%3A%22china-common%22%7D#/buy" target="_blank" rel="noopener noreferrer">阿里云OSS资源包购买页面</a>购买存储资源包。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731151755.png">
<img-annotation>选择存储套餐</img-annotation>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="创建存储空间">创建存储空间<a href="https://guru.kevin2li.top/blog/imagebed#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4" class="hash-link" aria-label="创建存储空间的直接链接" title="创建存储空间的直接链接">​</a></h3>
<p>在<a href="https://oss.console.aliyun.com/bucket" target="_blank" rel="noopener noreferrer">阿里云OSS管理控制台</a>界面创建存储Bucket，并将读写权限设置为<code>公共读</code>。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731152154.png">
<img-annotation>创建Bucket</img-annotation>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>读写权限一定要设置成"公共读"权限，这样外部才能访问到你的图片。</p></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>注意</div><div class="admonitionContent_BuS1"><p>阿里云的存储服务和流量服务是分开收费的，当你从外部访问你图床中的图片时还会产生流量费用(具体流量费用规则可查看: <a href="https://help.aliyun.com/zh/oss/product-overview/traffic-fees" target="_blank" rel="noopener noreferrer">阿里云OSS流量费用</a>)。因此为了产生不必要的扣费，你还需要在<a href="https://common-buy.aliyun.com/?spm=a2c4g.11186623.0.0.28c11887AxDVos&amp;commodityCode=ossbag&amp;request=%7B%22region%22%3A%22china-common%22%7D#/buy" target="_blank" rel="noopener noreferrer">阿里云OSS资源包</a>购买页面另外购买流量包。</p><img src="https://minio.kevin2li.site/image-bed/wiki/20240731202255.png"><img-annotation>流量包购买页面</img-annotation></div></div>
<p>Bucket创建完成后，进入Bucket，并创建一个目录用于存放图片。</p>
<p>目录名可以随便取，比如这里是<code>images</code>，这个名称要留意一下，后面填写PicGo配置时还会用到。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731152350.png">
<img-annotation>创建图片存储目录</img-annotation>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="创建用户">创建用户<a href="https://guru.kevin2li.top/blog/imagebed#%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7" class="hash-link" aria-label="创建用户的直接链接" title="创建用户的直接链接">​</a></h3>
<p>打开访问控制RAM控制台</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731160455.png">
<img-annotation>打开RAM控制台</img-annotation>
<p>创建新用户，用户名可以自己设置，但是一定要勾选<code>OpenAPI调用访问</code>。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731160548.png">
<img-annotation>创建用户</img-annotation>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731160650.png">
<img-annotation>勾选OpenAPI调用访问</img-annotation>
<p>点击确定后，应该会弹出一个安全验证窗口，可以选择手机号验证，成功后就会自动创建用户。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731160944.png">
<img-annotation>获取AccessKeyID和AccessKey Secret</img-annotation>
<p>在这个页面会提供<code>AccessKeyID</code>和<code>AccessKey Secret</code>信息，需要记录下来，这两个数据非常重要，后面需要在PicGo中正确填写。</p>
<p>用户也要保管好这个数据，阿里云出于安全考虑，在页面关闭后将无法再次查看。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="授权用户权限">授权用户权限<a href="https://guru.kevin2li.top/blog/imagebed#%E6%8E%88%E6%9D%83%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90" class="hash-link" aria-label="授权用户权限的直接链接" title="授权用户权限的直接链接">​</a></h3>
<p>接下来在"Bucket授权策略"中将之前添加的用户授予对Bucket的读写权限。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731195526.png">
<img-annotation>授权用户读写权限</img-annotation>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="在picgo中配置图床">在PicGo中配置图床<a href="https://guru.kevin2li.top/blog/imagebed#%E5%9C%A8picgo%E4%B8%AD%E9%85%8D%E7%BD%AE%E5%9B%BE%E5%BA%8A" class="hash-link" aria-label="在PicGo中配置图床的直接链接" title="在PicGo中配置图床的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置阿里云图床">配置阿里云图床<a href="https://guru.kevin2li.top/blog/imagebed#%E9%85%8D%E7%BD%AE%E9%98%BF%E9%87%8C%E4%BA%91%E5%9B%BE%E5%BA%8A" class="hash-link" aria-label="配置阿里云图床的直接链接" title="配置阿里�云图床的直接链接">​</a></h3>
<p>首先，要在『PicGo设置』中勾选显示"阿里云图床"。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731161611.png">
<p>然后，在『图床设置』中选择"阿里云OSS"进行设置。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731161709.png">
<p>点击编辑按钮，填写配置信息，注意这些信息务必要填写正确，否则会导致图片上传失败。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731162139.png">
<img-annotation>图床配置</img-annotation>
<p>参数填写说明：</p>
<table><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>KeyID</td><td>阿里云OSS控制台创建用户时提供的AccessKeyID</td></tr><tr><td>KeySecret</td><td>阿里云OSS控制台创建用户时提供的AccessKey Secret</td></tr><tr><td>Bucket</td><td>阿里云OSS中创建的Bucket名称</td></tr><tr><td>存储区域</td><td>阿里云OSS中创建的Bucket所在区域，例如在上海就填写:<code>oss-cn-shanghai</code>，如果你的Bucket在其他城市也可以替换成对应的拼音。</td></tr><tr><td>存储路径</td><td>图片在Bucket中存储的路径，即上面你在Bucket中创建的存放图片的目录名</td></tr></tbody></table>
<p>参数填写完成后，点击确认即可保存。</p>
<p>然后回到主页，选择阿里云OSS图床，找个图片验证一下是否可以上传成功。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731163248.png">
<p>如果你配置无误的话，此时应该能上传图片了。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="打开server">打开Server<a href="https://guru.kevin2li.top/blog/imagebed#%E6%89%93%E5%BC%80server" class="hash-link" aria-label="打开Server的直接链接" title="打开Server的直接链接">​</a></h3>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>提示</div><div class="admonitionContent_BuS1"><p>这个功能的作用是允许第三方应用通过调用PicGo的API实现图片的上传并获取返回的URL。比如后面PDF Guru Anki将会调用该API来批量上传图片。</p></div></div>
<p>打开"PicGo设置"菜单，点击"设置Server"按钮</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731202753.png">
<p>把Server开关打开，监听地址和端口号一般保持默认即可，后面在PDF Guru Anki中还会用到。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731202808.png">
<img-annotation>打开Server</img-annotation>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="anki图片批量上传图床">Anki图片批量上传图床<a href="https://guru.kevin2li.top/blog/imagebed#anki%E5%9B%BE%E7%89%87%E6%89%B9%E9%87%8F%E4%B8%8A%E4%BC%A0%E5%9B%BE%E5%BA%8A" class="hash-link" aria-label="Anki图片批量上传图床的直接链接" title="Anki图片批量上传图床的直接链接">​</a></h2>
<p>如果你做到了这里，恭喜你已经完成了教程最难的部分了，剩下的操作非常简单。</p>
<p>保持PicGo和Anki处于打开状态，然后打开PDF Guru Anki并切换到『图片管理』菜单。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/20240731204450.png">
<img-annotation>批量上传牌组图片</img-annotation>
<p>确认你的PicGo连接地址和你上一步PicGo的Server中设置的地址保持一致，然后选择你要批量上传的目标牌组，然后点击确定就会自动上传牌组中所有卡片里引用的本地图片到图床，并替换图片链接为URL。</p>
<p>当全部上传完成后，你的牌组就完成了一次大"瘦身"，同步压力大大减轻。</p>]]></content>
        <author>
            <name>Kevin2li</name>
            <uri>https://github.com/kevin2li</uri>
        </author>
        <category label="教程" term="教程"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[如何加快Anki同步速度？]]></title>
        <id>https://guru.kevin2li.top/blog/sync-accelerate</id>
        <link href="https://guru.kevin2li.top/blog/sync-accelerate"/>
        <updated>2024-07-31T13:03:16.000Z</updated>
        <summary type="html"><![CDATA[有过Anki使用经验的朋友应该知道，Anki官方提供的Ankiweb同步服务的同步速度是很慢的，尤其当你的牌组中有大量的图片、音频等媒体文件时，同步速度更是不堪忍受。本来你满心欢喜想要开始好好学习，谁曾想被糟心的同步服务扰乱了兴致，图片半天加载不出来，让人干着急。]]></summary>
        <content type="html"><![CDATA[<p>有过Anki使用经验的朋友应该知道，Anki官方提供的Ankiweb同步服务的同步速度是很慢的，尤其当你的牌组中有大量的图片、音频等媒体文件时，同步速度更是不堪忍受。本来你满心欢喜想要开始好好学习，谁曾想被糟心的同步服务扰乱了兴致，图片半天加载不出来，让人干着急。</p>
<img src="https://minio.kevin2li.site/image-bed/wiki/%E6%88%AA%E5%B1%8F%202024-07-31%2010.16.05.jpeg" width="60%">
<p>那么有什么办法可以加快同步速度呢？</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="为什么同步慢">为什么同步慢<a href="https://guru.kevin2li.top/blog/sync-accelerate#%E4%B8%BA%E4%BB%80%E4%B9%88%E5%90%8C%E6%AD%A5%E6%85%A2" class="hash-link" aria-label="为什么同步慢的直接链接" title="为什么同步慢的直接链接">​</a></h2>
<p>首先来分析下Ankiweb同步速度慢的原因，主要有：</p>
<ol>
<li>Ankiweb服务器位于国外，国内用户访问本身就偏慢</li>
<li>Ankiweb用户数量庞大，每个用户分到的带宽就小</li>
<li>用户自身的牌组文件体积较大，如包含大量图片、音频等媒体文件等，同步需要的时间也就更长</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="如何解决">如何解决<a href="https://guru.kevin2li.top/blog/sync-accelerate#%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3" class="hash-link" aria-label="如何解决的直接链接" title="如何解决的直接链接">​</a></h2>
<p>针对这些原因可以提出以下缓解办法：</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用梯子">使用"梯子"<a href="https://guru.kevin2li.top/blog/sync-accelerate#%E4%BD%BF%E7%94%A8%E6%A2%AF%E5%AD%90" class="hash-link" aria-label="使用&quot;梯子&quot;的直接链接" title="使用&quot;梯子&quot;的直接链接">​</a></h3>
<p>既然Ankiweb服务器位于国外，导致国内用户访问慢，那么如果你会"科学上网"的话，挂上"梯子"再进行同步，速度应该会有改善(这部分话题比较敏感，感兴趣用户可以自行探索，这里不再赘述)。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用自建同步服务器">使用自建同步服务器<a href="https://guru.kevin2li.top/blog/sync-accelerate#%E4%BD%BF%E7%94%A8%E8%87%AA%E5%BB%BA%E5%90%8C%E6%AD%A5%E6%9C%8D%E5%8A%A1%E5%99%A8" class="hash-link" aria-label="使用自建同步服务器的直接链接" title="使用自建同步服务器的直接链接">​</a></h3>
<p>既然Ankiweb服务器位于国外，并且人家用户基数大，每个人分到的带宽小，那么如果可以自己搭建一个同步服务器自己独享，同步速度理所当然就会提升很多。</p>
<p>那么Anki是否允许用户自行搭建服务器呢？答案是肯定的。Anki作为一款开源的闪卡软件，官方就提供了对用户自建同步服务器的支持，详情可查看<a href="https://docs.ankiweb.net/sync-server.html" target="_blank" rel="noopener noreferrer">Self-Hosted Sync Server | Anki官方手册</a>。</p>
<p>不过官方给的搭建教程还是太高级了，适合有一定计算机基础的朋友尝试，普通小白用户可能难以看懂。不过也不用担心，本软件对自建同步服务器的步骤进行了大大简化，小白用户也能轻松上手，详细教程可见：<a href="https://guru.kevin2li.top/docs/%E5%88%B6%E5%8D%A1%E6%95%99%E7%A8%8B/%E5%90%8C%E6%AD%A5%E6%9C%8D%E5%8A%A1%E5%99%A8/" target="_blank" rel="noopener noreferrer">Anki自建同步服务器</a>。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="减小同步数据体积">减小同步数据体积<a href="https://guru.kevin2li.top/blog/sync-accelerate#%E5%87%8F%E5%B0%8F%E5%90%8C%E6%AD%A5%E6%95%B0%E6%8D%AE%E4%BD%93%E7%A7%AF" class="hash-link" aria-label="减小同步数据体积的直接链接" title="减小同步数据体积的直接链接">​</a></h3>
<p>众所周知，文本占用的存储空间是远小于图片、音频、视频等媒体文件的，因此尽量制作文本形式的卡片可以有效减小存储体积，从而加快同步速度。</p>
<p>但是有时候不得不使用图片的情况，有办法继续优化吗？</p>
<p>也是有的。比如：</p>
<ol>
<li><strong>对图片等媒体文件进行压缩</strong></li>
</ol>
<p>同步慢的一个原因就是需要同步的数据量太大，如果在不影响用户观感体验的条件下对数据进行压缩，也能有效加快同步速度。</p>
<p>本软件提供了自动对牌组内图片进行批量压缩的功能，详情可见：<a href="https://guru.kevin2li.top/docs/%E5%88%B6%E5%8D%A1%E6%95%99%E7%A8%8B/%E5%9B%BE%E7%89%87%E7%AE%A1%E7%90%86/#%E5%8E%8B%E7%BC%A9%E5%9B%BE%E7%89%87" target="_blank" rel="noopener noreferrer">Anki制卡教程 | 图片管理</a></p>
<ol start="2">
<li><strong>把图片上传到图床</strong></li>
</ol>
<p>所谓"图床"，就是互联网中存储图片的空间,用户可以通过图片地址(通常为一个URL链接)来访问图床中图片。把图片上传到图床后，卡片中原本的图片就会被文本形式的图片URL链接来替代，相当于从图片数据转成了文本数据，数据量大大减小，同步速度自然会提升。</p>
<p>但是这里也会有个小的弊端，就是每次学习或查看卡片的时候需要保持设备联网，否则其中的图片无法显示，并且每次显示图片都是从网络加载，相比从本地加载速度也会稍慢。如果你可以接受这点，可以放心地把图片上传到图床。</p>
<p>详细的教程可参考：<a href="https://guru.kevin2li.site/blog/imagebed" target="_blank" rel="noopener noreferrer">Anki图床搭建教程</a>。</p>]]></content>
        <author>
            <name>Kevin2li</name>
            <uri>https://github.com/kevin2li</uri>
        </author>
        <category label="经验分享" term="经验分享"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[超强Anki制卡神器——『PDF Guru Anki』入坑指南，小白也能用Anki!]]></title>
        <id>https://guru.kevin2li.top/blog/tutorial</id>
        <link href="https://guru.kevin2li.top/blog/tutorial"/>
        <updated>2024-07-31T13:03:16.000Z</updated>
        <summary type="html"><![CDATA[本篇是粉丝投稿，以下的『我』均为粉丝本人，感谢该粉丝对PDF Guru Ani软件的大力支持，希望她的经历能给还在各种考试中苦苦挣扎的人一点启发和思考，找到适合自己的科学高效的学习方法，实现事半功倍，遥遥领先竞争对手!]]></summary>
        <content type="html"><![CDATA[<p>本篇是粉丝投稿，以下的『我』均为粉丝本人，感谢该粉丝对PDF Guru Ani软件的大力支持，希望她的经历能给还在各种考试中苦苦挣扎的人一点启发和思考，找到适合自己的科学高效的学习方法，实现事半功倍，遥遥领先竞争对手!</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>提醒</div><div class="admonitionContent_BuS1"><p>粉丝撰文时处于软件早期版本，其中介绍的部分功能随着软件持续迭代优化，界面可能和最新版已经差别较大，大家可以主要体会她的心路历程。</p></div></div>
<p>以下是粉丝投稿原文：</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="有手就会小白也能用anki">有手就会：小白也能用Anki！<a href="https://guru.kevin2li.top/blog/tutorial#%E6%9C%89%E6%89%8B%E5%B0%B1%E4%BC%9A%E5%B0%8F%E7%99%BD%E4%B9%9F%E8%83%BD%E7%94%A8anki" class="hash-link" aria-label="有手就会：小白也能用Anki！的直接链接" title="有手就会：小白也能用Anki！的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="作者序">作者序<a href="https://guru.kevin2li.top/blog/tutorial#%E4%BD%9C%E8%80%85%E5%BA%8F" class="hash-link" aria-label="作者序的直接链接" title="作者序的直接链接">​</a></h3>
<p>作为2024届本科毕业生，我也曾因“三考”共同推进而迷茫，所谓的三考，也就是这一年我选择了法考（天下第一大考），考研、考公，三者共同推进，学习任务繁重，我不得不考虑用一种较为轻松的方式帮助我顺利度过这三种考试。作为曾经的“小白”，到现在能熟练使用“PDF guru+anki”的选手，我将会将我探索的心路历程，以故事的方式带大家手把手使用这两个软件。</p>
<img src="https://picx.zhimg.com/80/v2-a8068a637b839dc21fa2f6500ad1a054_1440w.png?source=d16d100b">
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="除了anki你还需要一款辅助软件">除了anki，你还需要一款辅助软件<a href="https://guru.kevin2li.top/blog/tutorial#%E9%99%A4%E4%BA%86anki%E4%BD%A0%E8%BF%98%E9%9C%80%E8%A6%81%E4%B8%80%E6%AC%BE%E8%BE%85%E5%8A%A9%E8%BD%AF%E4%BB%B6" class="hash-link" aria-label="除了anki，你还需要一款辅助软件的直接链接" title="除了anki，你还需要一款辅助软件的直接链接">​</a></h3>
<p>作为法学生，我也曾苦苦探索究竟什么方式能让我记住浩如烟海的法条以及法条背后的知识。三年前，偶然的机会我听说过一款软件“anki”，据说能够实现《认知天性》这本书中所提倡的”闪记卡“般的功能。我热血沸腾，下载了软件“anki”，不过是绿色的anki，付费68.8，解锁全部功能，“一顿操作猛如虎，结果还是二百五”。软件下载错误，痛失68.8。</p>
<img src="https://picx.zhimg.com/80/v2-2197233ff555cc33f1c18bd2d249a360_1440w.png?source=d16d100b" width="50%">
<p>说出这段经历，是想要各位小白，不要输在“起跑线”上，真正的Anki软件是蓝色的，而不是绿色的，这是成功路上第一块绊脚石。
后来在看B站的过程中，我无意间发现博主的“Anki”怎么和我的不一样，因此我就开始了寻找真正“Anki”，好不容易驶入正轨，却发现一个致命的问题“这玩意压根不会用”。于是三年前的我选择放弃。</p>
<p>2023年7月，命运的齿轮开始转动。那时考研备考进入深水期，也是暑假关键冲刺阶段，法考将至，感觉压力一点点袭来，我总是失眠睡不着。在一个平常的失眠夜晚，我打开B站，搜索“anki快速制卡教程”，我们的主角“PDF Guru Anki”映入眼帘。我抱着好奇的心态点入，发现它确实能解决我的问题，毫不犹豫，我直接下单。我是一个对学习用具从来不心疼的人，而且，这个软件真的也就几杯奶茶的价钱，对学生党来说无比友好！接下来的备考历程中，我都在与这个软件死磕，一步步学习使用。也看到了不到半年，在UP主的努力下，软件在完善，在成长，变得更加友好。流量时代，“酒香也怕巷子深”。这也是我写这篇文章的初衷，有良心的作品值得被更多人推荐，值得被更多人认识。</p>
<p>“时代的每一粒尘，落在每一个人身上都是一座大山”。在如今的内卷大潮中，躺平不是最优解，唯有投入学习中，不断提高自己的能力，才能成为最终站在山顶的胜出者。学习确实是反人性的，学习有捷径吗？我的回答是没有，但是学习有科学的方式吗？我的回答是一定有。如今我仿佛越过属于自己的大山，在“选调生”考试中以第一名的成绩被顺利录取。这一路，是学习带给我勇气，带给我底气。低效学习，看不见进步只会让我们更加迷茫，接下来，我们一起走入科学学习的旅程。除了上述软件之外，我将重磅介绍“PDF Guru Anki”软件，在备考路上，是它，让我彻底改变思维，正式抛弃过去低效学习，敲开科学学习大门的历程.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="为什么说它可以实现科学学习">为什么说它可以实现科学学习<a href="https://guru.kevin2li.top/blog/tutorial#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%AF%B4%E5%AE%83%E5%8F%AF%E4%BB%A5%E5%AE%9E%E7%8E%B0%E7%A7%91%E5%AD%A6%E5%AD%A6%E4%B9%A0" class="hash-link" aria-label="为什么说它可以实现科学学习的直接链接" title="为什么说它可以实现科学学习的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="软件介绍">软件介绍<a href="https://guru.kevin2li.top/blog/tutorial#%E8%BD%AF%E4%BB%B6%E4%BB%8B%E7%BB%8D" class="hash-link" aria-label="软件介绍的直接链接" title="软件介绍的直接链接">​</a></h4>
<img src="https://pic1.zhimg.com/80/v2-51b060fb199a21f57b06505fe6ee07f9_1440w.png?source=d16d100b">
<p>从首页开始，首先，从形式而言，这款软件我很喜欢的是“简洁”，没有乱七八糟的广告乱入，主要关于“Anki”的是第一栏，七种模式，几乎可以满足所有制卡需求。而我接触最多的是PDF制卡，接下来，我着重介绍的也是PDF制卡。</p>
<p>前提，我们需要下载两款软件。蓝色的“Anki”，和蓝色的“PDF Guru Anki”软件。第一款蓝色的“Anki”对于安卓系统而言是免费的，对于苹果系统而言则需要付费。“PDF Guru Anki”软件需要付费购买，具体购买渠道有“B站”、“淘宝”。</p>
<p>安装之后，我们需要在“Anki”中装上几款插件，才能顺利将二者联动，装插件的方式我将以图片方式在下方进行展示。</p>
<img src="https://pic1.zhimg.com/80/v2-213b0c13925f54f11ed7ca432f0789d2_1440w.png?source=d16d100b">
<p>为什么要安装插件，据我朴素的理解来看就是将两个软件联动起来的方法，以及部分功能能够发生作用的前提。这一步也很关键，因为你会发现没有插件，两个软件还是“陌生人”，插件就像两人之间合作的纽带，最后“anki+guru”，变成无敌的老搭档。</p>
<img src="https://pic1.zhimg.com/80/v2-75ab8f3a05f4338d94fcb85418b69eea_1440w.png?source=d16d100b">
<p>这十款插件是我如今使用较为顺畅的，但是要实现两个软件联动，以及功能能够顺畅使用，只需要安装一部分。那么有小白看到这些奇奇怪怪的东西，又疑惑这些插件我是怎么找到的，其实很简单，只需要把名字记住之后，在Anki官方网站，就可以免费获取，这里我演示一下”AnkiConnect”的获取方法。</p>
<img src="https://picx.zhimg.com/80/v2-315aa838d8d3358876b0f701d495d5b5_1440w.png?source=d16d100b">
<img src="https://picx.zhimg.com/80/v2-fd79f5047c742852413a6330b0adb85b_1440w.png?source=d16d100b">
<p>如上图所示，随便一个浏览器搜索之后，就可以在Anki官网中获取插件代码“2055492159”，再按照插件安装方式输入即可。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pdf批注">PDF批注<a href="https://guru.kevin2li.top/blog/tutorial#pdf%E6%89%B9%E6%B3%A8" class="hash-link" aria-label="PDF批注的直接链接" title="PDF批注的直接链接">​</a></h4>
<p>既然是PDF制卡，我们就要准备好标注好的PDF，标注PDF从自我的角度来说可以理解为将荧光笔在你的全新PDF上作记号，但是该记号也不能随心所欲的制作，要让我们的“PDF Guru Anki”识别之后进行处理，才能通过软件顺利导入软件“Anki”中实现批量复习。</p>
<p>首先打开一个你需要复习的PDF，具体打开用什么软件没有特殊要求，wps、万兴等市面上常见的软件均可做基础的批注。</p>
<p>对于批注规则，那就是红色框线是卡片区域，而高亮是遮挡区域，用于复习的区域，具体图示如下。</p>
<img src="https://picx.zhimg.com/80/v2-e690b557aff7fa922f85695530f5b4e4_1440w.png?source=d16d100b">
<p>红色框线是“批注”选项卡中“形状批注”的矩形批注，黄色高亮为“批注”选项卡中“区域高亮”处。注意！！！必须按照此批注规则对PDF进行批注，否则软件无法识别。批注后的PDF一定要进行保存，并放在一个你能够迅速找到的位置进行保存。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pdf导入pdf-guru-anki处理">PDF导入『PDF Guru Anki』处理<a href="https://guru.kevin2li.top/blog/tutorial#pdf%E5%AF%BC%E5%85%A5pdf-guru-anki%E5%A4%84%E7%90%86" class="hash-link" aria-label="PDF导入『PDF Guru Anki』处理的直接链接" title="PDF导入『PDF Guru Anki』处理的直接链接">​</a></h4>
<img src="https://picx.zhimg.com/80/v2-ad16cc96d1136d31a73e991a53a852a2_1440w.png?source=d16d100b">
<p>打开该页面，我们遇到的第一关是“父牌组”，曾经也是小白的我看见这个也是一脸懵，心里嘀咕着这是什么？于是我们刚刚所说的插件的作用来了，所谓的牌组就是“Anki”软件中，你为你的知识建造的“家”，每一科每一个知识点都建造一个“牌组”作为你需要复习的知识点的“家”。那么构建方式如下。</p>
<img src="https://picx.zhimg.com/80/v2-db243626e690ee6fc451230203aca300_1440w.png?source=d16d100b">
<p>直接点击“Anki”界面，最下方“创建牌组”你就可以给你的父牌组命名，然后在“guru”中输入你刚刚创建的牌组。</p>
<p>接下来，再将我们之前标注好的PDF导入“输入”框即可，全程傻瓜式填空操作，你却能得到无数张卡片。直接返回“Anki”软件中，点开我们所创建的父牌组，就可以看到一张张已经制作完毕的卡片，然后在具体的页面中进行复习即可。</p>
<img src="https://pic1.zhimg.com/80/v2-33859ffe485e85ddc11a1e2780c767d5_1440w.png?source=d16d100b">
<p>在每次复习反馈时，我们还可以点击1234键分别对应难度“重来”、“困难”、“良好”、“简单”进行复习反馈，“Anki”软件可以根据你平时复习情况，安排卡牌数量，每天只需要傻瓜式根据所给到的卡牌数量一一完成任务，把简单的事情做到极致，你便可以看见自己的进步。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="打破自己">打破自己<a href="https://guru.kevin2li.top/blog/tutorial#%E6%89%93%E7%A0%B4%E8%87%AA%E5%B7%B1" class="hash-link" aria-label="打破自己的直接链接" title="打破自己的直接链接">​</a></h3>
<p>“你是你人生唯一的高墙，越过去，你便看到光”。在七月之前，我也曾在传统学习中苦苦挣扎，甚至怀疑自己是不是不应该学法，在浩如烟海的知识中用薄弱的记忆里去应对。科学的学习方法可以为学习插上翅膀，改变自己，从尝试新的学习方式开始，每一次都有打破自我，重塑自我的感觉。</p>
<p>当我22岁大四才尝试到原来计算机可以用来记忆，原来Anki这么神奇的时候，在UP主建的会员群，我才知道有人从小学就开始使用Anki，有人因为“双减政策”只能尝试用制卡的方式帮助子女学习，将一本本故事书制作成一个个牌组，让自己的孩子反复观看。原来思维是竞争的起点，很感谢考研考公让我深入接触这款软件，也感谢有人一直在默默维护“anki”，当看见无数中国学生在学海里挣扎，有人将其引入中国，更重要的是，有人一直以“我要做有意义的事情”为人生目标，在软件背后默默开发。这才有“PDF Guru Anki”从下载都很麻烦到如今安装很丝滑，也有了首页不断完善的功能。</p>
<p>我所介绍的PDF制卡只是其中最为基础的功能，当你打开这款软件之后，这也仿佛“潘多拉的魔盒”，你会发现法考错题可以变成问答题，你的文档可以批量生成问答题，考研英语也可以成为生动的单词卡片，无数功能，你仿佛在升级打怪，我永远忘不了当我第一次安装Mac版本，那时候软件没这么完善，需要进行程序改写才能安装，一次次尝试之后终于成功的喜悦，在上大学之后这种久违的挑战自己的感觉，仿佛上一次只是在解出高考压轴题时才隐隐约约出现过。</p>
<p>作为曾经的小白，我也明白当无数次尝试之后如果还是不成功，有的人会选择放弃，然后在类似的学习平台上不屑的说“其实也就这样，比不上传统学习方法”。但是这何尝不是失败之后的恼羞成怒？群友们总说这款软件是有门槛的，但我从来不这样认为，也许那道门槛就是自己，当你学会之后，它可以帮助你轻松通过各种各样的考试，坚持是突破这道门槛唯一的秘诀。也许很多成功都是死磕的结果，我也期待着你成为anki制卡的大神，那么成为大神之前，“guru”便是一个万能“辅助”！</p>
<p>当学习变成一场场有趣的游戏时，你还害怕进入吗？</p>]]></content>
        <author>
            <name>Kevin2li</name>
            <uri>https://github.com/kevin2li</uri>
        </author>
        <category label="经验分享" term="经验分享"/>
    </entry>
</feed>